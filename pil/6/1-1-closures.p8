pico-8 cartridge // http://www.pico-8.com
version 18
__lua__
--when a function is written
--enclosed in another function,
--it has full access to local
--variables from the enclosing
--function; this feature is
--called lexical scoping.

function _init()

end

function _update()

end

function _draw()

end
-->8
--closure is a function plus
--all it needs to access its
--upvalues correctly.

function newcounter ()
 local i = 0
 -- anonymous function
	return function ()
	 --uses upvalue i
  i = i + 1
  return i
	end
end

--i is out of scope yet it can
--be used by the call.
c1=newcounter()
print(c1()) --> 1
print(c1()) --> 2 (!)

c2=newcounter()
print(c2()) --> 1
print(c1()) --> 3

--so, c1 and c2 are different
--closures over the same
--function and each acts upon
--an independent instantiation
--of the local variable i. 
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
